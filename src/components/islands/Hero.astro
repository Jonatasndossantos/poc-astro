---
import { type Mode } from "../../types";
import gsap from "gsap";
import lenis from "lenis";
import { ArrowDown } from "lucide-react";
import { tv } from "tailwind-variants";
import { twMerge } from "tailwind-merge";
import type { ComponentProps } from "react";
import SplineViewer from "./SplineViewer";
import { getTranslations } from "@i18n";

const heroVariants = tv({
    base: "relative min-h-screen w-full flex flex-col justify-center px-6 lg:px-20 overflow-hidden pt-32 pb-20",
});

/**
 * Hero receives pre-resolved, locale+mode-aware strings from the Astro parent.
 * No i18n logic here â€” pure rendering.
 *
 * The Astro parent does:
 *   <Hero bio={profile.bio[mode]} role={profile.role[mode]} ... />
 */

const { lang, mode } = Astro.props;
const profile = (await getTranslations(lang, "profile")) as Record<string, any>;
---

<script>
    import { Application } from "@splinetool/runtime";

    const canvas = document.getElementById("canvas3d") as HTMLCanvasElement;
    if (canvas) {
        const app = new Application(canvas);
        app.load(
            "https://prod.spline.design/VG3XFeiaQtFZaSOq/scene.splinecode",
        );
    }
</script>

<section
    class="relative min-h-screen w-full flex flex-col justify-center px-6 lg:px-20 overflow-hidden pt-32 pb-20"
>
    <div class="absolute inset-0 z-0 opacity-60 hero-parallax">
        <canvas id="canvas3d" class="w-full h-full border-0 relative z-0"
        ></canvas>

        <!-- Watermark Hider via Gradient -->
        <div
            class="absolute bottom-0 right-0 w-64 h-24 bg-gradient-to-tl from-base-300 via-base-300/60 to-transparent z-10 pointer-events-none"
        >
        </div>
    </div>

    <div
        class="absolute inset-0 bg-gradient-to-t from-base-300/90 via-base-300/40 to-transparent z-0 pointer-events-none"
    >
    </div>
    <div
        class="absolute inset-0 z-0 opacity-[0.03] pointer-events-none mix-blend-overlay"
        style={{
            backgroundImage:
                'url("https://grainy-gradients.vercel.app/noise.svg")',
        }}
    >
    </div>

    <header
        class="relative z-10 w-full max-w-4xl hero-parallax text-left flex flex-col justify-center"
    >
        <h1
            class="text-6xl md:text-8xl font-bold leading-tight tracking-tighter mb-2 text-balance break-keep"
        >
            {profile.greeting}
        </h1>

        <h2
            class="opacity-80 text-4xl md:text-5xl font-light mb-8 text-balance break-keep"
        >
            {profile.modes[mode].role}
        </h2>

        <div
            class="text-2xl md:text-3xl font-medium mb-8 flex flex-wrap gap-2 items-center"
        >
            <span>{profile.providingSolutionsFor}</span>
            <span
                class="text-rotate h-10 inline-block overflow-hidden align-bottom"
            >
                <span class="flex flex-col text-left">
                    <span class="text-accent h-10">{profile.designers}</span>
                    <span class="text-secondary h-10">{profile.developers}</span
                    >
                    <span class="text-primary h-10">{profile.managers}</span>
                    <span class="text-accent h-10">{profile.designers}</span>
                </span>
            </span>
        </div>

        <p
            class="text-lg md:text-xl max-w-xl leading-relaxed mb-10 text-pretty opacity-80 break-keep"
        >
            {profile.modes[mode].bio}
        </p>
    </header>

    <div
        class="absolute bottom-10 right-10 hidden md:block animate-bounce z-10 pointer-events-none"
    >
        <div
            class="text-xs font-mono opacity-50 rotate-90 origin-bottom-right tracking-widest"
        >
            {profile.scroll}
        </div>
    </div>
</section>
